<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Interactive SVG Icon Map Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      * {
        margin: 0;
        padding: 0;
      }

      html,
      body,
      #map {
        width: 100%;
        height: 100%;
      }
    </style>

    <!-- Import the required libraries -->
    <script src="../../lib/ngw-mapbox.global.js"></script>
    <script src="../../../icons/lib/icons.global.js"></script>
  </head>

  <body>
    <div id="map"></div>
    <script>
      // Initializing the NGW Map with basic parameters
      NgwMap.create({
        baseUrl: 'https://demo.nextgis.com',
        target: 'map',
        qmsId: 529,
        zoom: 13,
      }).then((ngwMap) => {
        const svgResourceId = 6592;

        // Fetching the SVG resource from the NGW
        ngwMap.connector.getResource(svgResourceId).then((res) => {
          const promises = [];

          // Loop over the SVG files and fetch each of them
          for (const file of res.svg_marker_library.files) {
            promises.push(
              ngwMap.connector.get('resource.file_download', {
                params: { id: svgResourceId, name: file.name },
              }),
            );
          }

          // Once all SVGs are fetched, add them as layers on the map
          Promise.all(promises).then((icons) => {
            // Add routes
            ngwMap.addNgwLayer({
              resource: 6587,
            });
            ngwMap.addNgwLayer({
              resource: 6589,
            });

            // Add SVG icon layer for Metro
            ngwMap.addNgwLayer({
              resource: 6585,
              fit: true,
              adapterOptions: {
                paint: Icons.getIcon({
                  svg: icons[0],
                  size: 20,
                }),
                selectable: true,
                selectedPaint: Icons.getIcon({
                  svg: icons[0],
                  size: 30,
                }),
              },
            });

            // Add SVG icon layer for NextGIS office
            ngwMap.addNgwLayer({
              id: 'office',
              resource: 6583,
              interactive: false,
              adapterOptions: {
                paint: Icons.getIcon({
                  svg: icons[1],
                  size: 20,
                }),
              },
            });
          });
        });
      });
    </script>
  </body>
</html>
